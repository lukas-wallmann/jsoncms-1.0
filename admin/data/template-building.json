{"title":"template building","id":"63","file":"template-building.json","menuid":"103","content":[{"type":"text","content":"<p>Template Building never was easyer than with json cms.<br />\nThere are 4 Files in Template directory</p>\n\n<ul>\n\t<li>getData.php - you can ignore this, its the request and parse of the needed json files</li>\n\t<li>index.php - your template code</li>\n\t<li>menu.php - the functions to write menu, simple to change</li>\n\t<li>site.php - the functions to write the page contents, also very simple if you need to change somethig</li>\n</ul>\n\n<p>if you start to build your own template, you will need three functions:</p>\n"},{"type":"code","content":"<!-- gives you the page title -->\n<?php echo getTitle() ?>\n\n<!-- as example -->\n<h1><?php echo getTitle() ?></h1>"},{"type":"code","content":"<!-- This is the function to output Menu -->\n<?php echo getMenu(\"YOUR MENU NAME\",\"HANDLE FUNCTION\") ?>\n\n<!-- Write the navigation \"MAIN_MENU\" -->\n<nav><?php echo getMenu(\"MAIN_MENU\",\"mainMenuHandle\") ?></nav>\n\n<!-- detailed infos to mainMenuhandle in menu.php in base template -->"},{"type":"code","content":"<!-- gives you all the page contents -->\n<?php echo getContents() ?>\n\n<!-- for example the output of the whole site -->\n<main>\n      <!-- output the tilte as h1 -->\n      <h1><?php echo getTitle() ?></h1>\n      <!-- output the contents of the site -->\n      <?php echo getContents() ?>\n</main>"},{"type":"text","content":"<p>To start at zero, you could use a code like this:</p>\n"},{"type":"headline","content":{"type":"2","content":"index.php"}},{"type":"code","content":"<?php\n  include \"getData.php\";\n  include \"menu.php\";\n  include \"site.php\";\n?>\n\n<!DOCTYPE html>\n<html>\n  <head>\n    <title><?php echo getTitle() ?></title>\n  </head>\n\n  <body>\n    <nav><?php echo getMenu(\"MAIN_MENU\",\"mainMenuHandle\") ?></nav>\n    <main>\n      <h1><?php echo getTitle() ?></h1>\n      <?php echo getContents() ?>\n    </main>\n    <footer><nav><?php echo getMenu(\"META_MENU\",\"mainMenuHandle\") ?></nav></footer>\n  </body>\n\n</html>"},{"type":"headline","content":{"type":"2","content":"getData.php"}},{"type":"code","content":"<?php\n\n// Handle sitelist for menÃ¼ and site\n$filename=\"admin/data/__sitelist.json\";\n$fo = fopen($filename,\"r\");\n$__sitelist = json_decode(fread($fo, filesize($filename)));\n\n// Handle the site data\n$title=$__sitelist->sites[0]->title;\n$file=$__sitelist->sites[0]->file;\n$get_file=isset($_GET['title']) ? $_GET['title'] : '';\n\n//if sitename given via get\nif($get_file!=\"\"){\n  $file=$get_file.\".json\";\n}\n//Add the path to file\n$file=\"admin/data/\".$file;\n$fo_content = fopen($file,\"r\");\n$__contents = json_decode(fread($fo_content, filesize($file)));\n\n?>\n"},{"type":"headline","content":{"type":"2","content":"menu.php"}},{"type":"code","content":"<?php\n\n  //Search Menu group (first childNodes of __sitelist.menu)\n  function getMenu($name,$handle){\n    for($i=0; $i<count($GLOBALS[\"__sitelist\"]->menu); $i++){\n      if($GLOBALS[\"__sitelist\"]->menu[$i]->title == $name){\n        $code=$handle($GLOBALS[\"__sitelist\"]->menu[$i]->sub);\n        return $code;\n        break;\n      };\n    }\n  }\n  //Handlefunction - that calls itself recursivly till all menus got\n  function mainMenuHandle($m){\n    $code=\"\";\n    foreach ($m as $menupoint){\n      $link=getLink($menupoint->id);\n      $target=\"_top\";\n      if($menupoint->action!=\"\")$link=$menupoint->action;\n      if($menupoint->target!=\"\")$target=$menupoint->target;\n      $code.=\"<li><a href='\".$link.\"' target='\".$target.\"'>\".$menupoint->title.\"</a>\";\n      if(count($menupoint->sub)>0){\n        $code.=mainMenuHandle($menupoint->sub);\n      }\n      $code.=\"</li>\";\n\n    }\n    return \"<ul>\".$code.\"</ul>\";\n  }\n\n  //Helper function to search link from __sitelist.sites\n  function getLink($menuid){\n    $link=\"#\";\n    foreach($GLOBALS[\"__sitelist\"]->sites as $site){\n      if($site->menuid==$menuid){\n        $link=\"?title=\".preg_replace('/\\\\.[^.\\\\s]{3,4}$/', '', $site->file);\n        break;\n      }\n    }\n    return $link;\n  }\n\n?>\n"},{"type":"headline","content":{"type":"2","content":"site.php"}},{"type":"code","content":"<?php\n\n  //Gives Page Title\n  function getTitle(){\n    return $GLOBALS[\"__contents\"]->title;\n  }\n\n  //Gives the contents\n  function getContents(){\n\n    $code=\"\";\n\n    foreach ($GLOBALS[\"__contents\"]->content as $element){\n\n      switch ($element->type) {\n          case \"text\":\n              $code.=\"<div class='item text'>\".$element->content.\"</div>\";\n              break;\n          case \"headline\":\n              $code.=\"<h\".$element->content->type.\" class='item text'>\".$element->content->content.\"</h\".$element->content->type.\">\";\n              break;\n          case \"code\":\n              $search=array(\"<\",\">\");\n              $replace=array(\"<\",\">\");\n              $code.=\"<pre class='item code'><code class='language-php'>\".str_replace($search,$replace,$element->content).\"</code></pre>\";\n              break;\n          case \"image\":\n              $code.=\"<figure class='item image'><img src='/admin/\".$element->content->image.\"' alt='\".$element->content->description.\"'><figcaption>\".$element->content->description.\"</figcaption></figure>\";\n              break;\n          case \"text_image\":\n              $img=\"/admin/\".$element->content->image;\n              $code.=\"<div class='item text_image \".$element->content->align.\"'><div>\".$element->content->text.\"</div><a href='\".$img.\"'><img src='\".$img.\"'></a></div>\";\n              break;\n          case \"gallery\":\n              $code.=\"<div class='item gallery'>\";\n              foreach ($element->content as $img) {\n                $url=\"/admin/\".$img->src;\n                $link=\"/admin/\".$img->srcbig;\n                $code.=\"<a href='\".$link.\"'><img src='\".$url.\"'><span>\".$img->description.\"</span></a>\";\n              }\n              $code.=\"</div>\";\n              break;\n          case \"downloads\":\n              $code.=\"<div class='item downloads'>\";\n              foreach ($element->content as $download) {\n                $url=\"/admin/\".$download->filename;\n                $code.=\"<a href='\".$url.\"'>\".$download->name.\"</a>\";\n              }\n              $code.=\"</div>\";\n              break;\n          case \"video\":\n              $code.=\"<div class='item video'><div class='youtube'><iframe src='https://www.youtube.com/embed/\".$element->content->id.\"' frameborder='0' allowfullscreen></iframe></div></div>\";\n              break;\n          case \"html\":\n              $code.=\"<div class='item html'>\".$element->content.\"</div>\";\n              break;\n\n      }\n\n    }\n\n    return $code;\n\n  }\n\n?>\n"}]}